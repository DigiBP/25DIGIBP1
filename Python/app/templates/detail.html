{% extends "layout.html" %}
{% block content %}
<div class="container-fluid">
<div class="row g-3">
  <div class="col-md-2"><label>Datum</label><input class="form-control" value="{{ row.feedbackDate.date() if row.feedbackDate }}" readonly></div>
  <div class="col-md-2"><label>Vorname</label><input class="form-control" value="{{ row.firstName }}" readonly></div>
  <div class="col-md-2"><label>Nachname</label><input class="form-control" value="{{ row.lastName }}" readonly></div>
  <div class="col-md-4"><label>E-Mail</label><input class="form-control" value="{{ row.email }}" readonly></div>
  <div class="col-md-2"><label>Telefon</label><input class="form-control" value="{{ row.phone }}" readonly></div>

  <div class="col-md-2"><label>Feedback Typ</label><input class="form-control" value="{{ row.feedbackType }}" readonly></div>
  <div class="col-md-2"><label>Dringlichkeit</label><input class="form-control" value="{{ row.urgency }}" readonly></div>
  <div class="col-md-2"><label>Auswirkung</label><input class="form-control" value="{{ row.impactScope }}" readonly></div>

  <div class="col-md-2"><label>Status</label><input class="form-control" value="{{ row.status }}" readonly></div>
  <div class="col-md-4">
    <label>Getroffene Massnahmen</label>
    <textarea name="measuresTaken" class="form-control bg-info-subtle" rows="3">{{ row.measuresTaken }}</textarea>
  </div>
</div>

<label class="mt-3">Feedback</label>
<textarea class="form-control" rows="6" readonly>{{ row.feedbackText }}</textarea>

<div class="d-flex gap-3 mt-4">

  <!-- 1) Terminieren braucht keine Massnahmen -->
  <form action="{{ url_for('terminate', idx=idx) }}" method="post">
    <button class="btn btn-danger w-100">Feedback Terminieren</button>
  </form>

  <!-- 2) Massnahmen speichern: Textarea MIT im Formular -->
  <form action="{{ url_for('update_measures', idx=idx) }}" method="post" class="flex-fill">
    <button class="btn btn-secondary w-100">Massnahmen Aktualisieren</button>
  </form>

  <!-- 3) Feedback abschliessen: gleiche Textarea mitsenden -->
  <form action="{{ url_for('complete_feedback', idx=idx) }}" method="post" class="flex-fill">
    <button class="btn btn-primary w-100">Feedback Abschliessen</button>
  </form>

  <!-- Schliessen-Link (kein Formular) -->
  <a class="btn btn-outline-light ms-auto" href="{{ url_for('index') }}">Schliessen</a>
</div>
{% endblock %}
